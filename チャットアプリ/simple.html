<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Firebase_version9_RealtimeDB(G'sACADEMYåˆå­¦è€…ç”¨ã‚µãƒ³ãƒ—ãƒ«)</title>
</head>
<body>

<!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->

<div>
    <div> åå‰ï¼š<input type="text" id="uname"> </div>
    <div>
        <textarea id="text" cols="30" rows="10"></textarea>
        <button id="send">é€ä¿¡</button>
    </div>
    <div id="output"></div>
</div>
<!--/ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->



<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
 <!-- JQuery -->
<script type="module">

// <!--** ä»¥ä¸‹Firebase **-->

// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";
import { getDatabase, ref, push, set, onChildAdded, remove,onChildRemoved } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDjyJvho-y-asKbsxNH-bG2BnYUmOjyivI",
  authDomain: "dev245-76f99.firebaseapp.com",
  projectId: "dev245-76f99",
  storageBucket: "dev245-76f99.appspot.com",
  messagingSenderId: "1063949793636",
  appId: "1:1063949793636:web:2bde15c8a1894880336271"
};

// Initialize FirebaseS
const app = initializeApp(firebaseConfig);


const db=getDatabase(app);
const dbRef=ref(db,'dev245');

// é€ä¿¡å‡¦ç†ã‚’è¨˜è¿°
$('#send').on('click',function(){
    // ID="Uname"ã®å ´æ‰€ã‚’å–å¾—
    const uname= $('#uname').val();

    // Id textã®å ´æ‰€ã‚’å–å¾—
    const text =$('#text').val();

    // alert(uname);
    // console.log(uname,text)
      // ãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’ä½œã‚Šã¾ã™ğŸ¤—
            // msg ã¨ã„ã†åå‰ã§å¡Šã‚’ä½œã‚Šã¾ã™
            // unameã¨ã„ã†éµã®åå‰
            // textã¨ã„ã†ã‚«ã‚®ã®åå‰
            // ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã®å¡Šã‚’firebaseã«é€ä¿¡ã‚’ã—ã¾ã™â‡¨ã¤ã¾ã‚Šã“ã‚ŒãŒä¿å­˜ã«ãªã‚Šã¾ã™ğŸ¤—
            const msg = {
                uname: uname,
                text: text,
            }

            // firebaseã«é€ã‚‹æº–å‚™ã‚’ã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ğŸ¤—
            const newPostRef = push(dbRef) //ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã§ãã‚‹æº–å‚™
            set(newPostRef, msg); // firebaseã®ç™»éŒ²ã§ãã‚‹å ´æ‰€ã«ä¿å­˜ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ğŸ¤—
    
                        // é€ä¿¡å¾Œã«ã€å…¥åŠ›æ¬„ã‚’ç©ºã«ã—ã¾ã—ã‚‡ã†ğŸ¤—
                        $('#uname').val("");
            $('#text').val("");

            // ã“ã‚Œã‚’ä½¿ã†ã¨ã©ã†ãªã‚‹ã‹ã¿ã¦ã¿ã¾ã—ã‚‡ã†ğŸ¤—
            $("#uname").focus();


            
    // Sendé€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆã“ã®ä¸‹æ¶ˆã•ãªã„
            


}); 
       // å—ä¿¡å‡¦ç†ã‚’è¨˜è¿°
       onChildAdded(dbRef, function (data) {
            // ã“ã“ã‹ã‚‰ãŒå—ä¿¡å‡¦ç†ãŒå§‹ã¾ã‚Šã¾ã™

            // ç™»éŒ²ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ğŸ¤—
            const msg = data.val();
            console.log(msg, 'å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®å¡Š')
            const key = data.key;
            console.log(key, 'ãƒ‡ãƒ¼ã‚¿ã®å¡Šã«ã‚¢ã‚¯ã‚»ã‚¹')
        })
</script>

</body>
</html>
































